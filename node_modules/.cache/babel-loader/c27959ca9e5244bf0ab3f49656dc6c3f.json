{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\Reyna\\\\Documents\\\\GitHub\\\\SWEN90013\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"C:\\\\Users\\\\Reyna\\\\Documents\\\\GitHub\\\\SWEN90013\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Reyna\\\\Documents\\\\GitHub\\\\SWEN90013\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\Reyna\\\\Documents\\\\GitHub\\\\SWEN90013\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Reyna\\\\Documents\\\\GitHub\\\\SWEN90013\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Reyna\\\\Documents\\\\GitHub\\\\SWEN90013\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Reyna\\\\Documents\\\\GitHub\\\\SWEN90013\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Reyna\\\\Documents\\\\GitHub\\\\SWEN90013\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Reyna\\\\Documents\\\\GitHub\\\\SWEN90013\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Reyna\\\\Documents\\\\GitHub\\\\SWEN90013\\\\src\\\\components\\\\dashboard\\\\Proposals\\\\AllProposals\\\\AllProposals.js\";\n\n/**\r\n * This component contains all proposals. It is entered via a \"View All Proposals\" button on the Proposals page.\r\n * Author: Reyna Tan\r\n * Date: 07/05/2019\r\n */\nimport React, { PureComponent } from 'react';\nimport store from \"../../../../store\";\nimport { getProposalList, getAllSubjects } from \"../../../../api\";\nimport { getAllProposalsAction, getAllSubjectsAction } from \"../../../../store/actionCreators\";\nimport MaterialTable from 'material-table';\n\nvar AllProposals =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(AllProposals, _PureComponent);\n\n  function AllProposals(props) {\n    var _this;\n\n    _classCallCheck(this, AllProposals);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AllProposals).call(this, props));\n    _this.state = store.getState();\n    _this._handleStoreChange = _this._handleStoreChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    store.subscribe(_this._handleStoreChange);\n    return _this;\n  }\n\n  _createClass(AllProposals, [{\n    key: \"_handleStoreChange\",\n    value: function _handleStoreChange() {\n      this.setState(store.getState());\n    }\n  }, {\n    key: \"_reqTodoList\",\n    value: function () {\n      var _reqTodoList2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var proposals, getAllProposalsAct, subjects, getAllSubjectsAct;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return getProposalList();\n\n              case 2:\n                proposals = _context.sent;\n                getAllProposalsAct = getAllProposalsAction(proposals);\n                store.dispatch(getAllProposalsAct);\n                _context.next = 7;\n                return getAllSubjects();\n\n              case 7:\n                subjects = _context.sent;\n                getAllSubjectsAct = getAllSubjectsAction(subjects);\n                store.dispatch(getAllSubjectsAct);\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function _reqTodoList() {\n        return _reqTodoList2.apply(this, arguments);\n      }\n\n      return _reqTodoList;\n    }()\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._reqTodoList();\n    }\n  }, {\n    key: \"_extractYear\",\n    value: function _extractYear(str) {\n      // Format in which the date is stored in the DB: 2019-10-07T03:34:16.921Z\n      // Slice the string using \"-\" and extract only the first element\n      return str.split(\"-\")[0];\n    }\n  }, {\n    key: \"_formatDataIntoTableList\",\n    value: function _formatDataIntoTableList() {\n      var _this2 = this;\n\n      var proposals = this.state.proposals;\n      var proposalList = [];\n      proposals.forEach(function (p) {\n        var nextProposal = {\n          year: _this2._extractYear(p.date),\n          name: p.name,\n          client: p.client.firstName + \" \" + p.client.lastName,\n          outlineOfProject: p.outlineOfProject,\n          status: p.status,\n          subjectId: p.subjectId\n        };\n        proposalList.push(nextProposal);\n      });\n      return proposalList;\n    }\n  }, {\n    key: \"_getSubjectFilterLookup\",\n    value: function _getSubjectFilterLookup() {\n      var proposals = this.state.proposals;\n      var subjectList = {};\n      proposals.forEach(function (p) {\n        if (!(p.subjectId in subjectList)) {\n          subjectList[p.subjectId] = p.subjectId;\n        }\n      });\n      return subjectList;\n    }\n  }, {\n    key: \"_handleClick\",\n    value: function _handleClick(_id) {\n      var history = this.props.history;\n      history.push(\"/dashboard/projects/\".concat(_id));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(MaterialTable, {\n        title: \"All Projects\",\n        columns: [{\n          title: 'Year',\n          field: 'year',\n          filterCellStyle: {\n            maxWidth: 50\n          }\n        }, {\n          title: 'Proposal Name',\n          field: 'name'\n        }, {\n          title: 'Client',\n          field: 'client'\n        }, {\n          title: 'Description',\n          field: 'outlineOfProject',\n          filtering: false\n        }, {\n          title: 'Status',\n          field: 'status',\n          lookup: {\n            new: 'New',\n            approved: 'Approved',\n            rejected: 'Rejected'\n          },\n          filterCellStyle: {\n            paddingTop: 0\n          }\n        }, _defineProperty({\n          title: 'Subject',\n          field: 'subjectId',\n          filterCellStyle: {\n            maxWidth: 50\n          },\n          lookup: this._getSubjectFilterLookup()\n        }, \"filterCellStyle\", {\n          paddingTop: 0\n        })],\n        data: this._formatDataIntoTableList(),\n        options: {\n          filtering: true\n        },\n        onRowClick: function onRowClick(event, rowData) {\n          return _this3._handleClick(rowData._id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return AllProposals;\n}(PureComponent);\n\nexport default AllProposals;","map":{"version":3,"sources":["C:\\Users\\Reyna\\Documents\\GitHub\\SWEN90013\\src\\components\\dashboard\\Proposals\\AllProposals\\AllProposals.js"],"names":["React","PureComponent","store","getProposalList","getAllSubjects","getAllProposalsAction","getAllSubjectsAction","MaterialTable","AllProposals","props","state","getState","_handleStoreChange","bind","subscribe","setState","proposals","getAllProposalsAct","dispatch","subjects","getAllSubjectsAct","_reqTodoList","str","split","proposalList","forEach","p","nextProposal","year","_extractYear","date","name","client","firstName","lastName","outlineOfProject","status","subjectId","push","subjectList","_id","history","title","field","filterCellStyle","maxWidth","filtering","lookup","new","approved","rejected","paddingTop","_getSubjectFilterLookup","_formatDataIntoTableList","event","rowData","_handleClick"],"mappings":"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","sourcesContent":["/**\r\n * This component contains all proposals. It is entered via a \"View All Proposals\" button on the Proposals page.\r\n * Author: Reyna Tan\r\n * Date: 07/05/2019\r\n */\r\n\r\nimport React, { PureComponent } from 'react';\r\nimport store from \"../../../../store\";\r\nimport {getProposalList, getAllSubjects} from \"../../../../api\";\r\nimport {getAllProposalsAction, getAllSubjectsAction} from \"../../../../store/actionCreators\";\r\nimport MaterialTable from 'material-table';\r\n\r\nclass AllProposals extends PureComponent {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = store.getState();\r\n\r\n        this._handleStoreChange = this._handleStoreChange.bind(this);\r\n        store.subscribe(this._handleStoreChange);\r\n    }\r\n\r\n    _handleStoreChange() {\r\n        this.setState(store.getState());\r\n    }\r\n\r\n    async _reqTodoList() {\r\n        const proposals = await getProposalList();\r\n        const getAllProposalsAct = getAllProposalsAction(proposals);\r\n        store.dispatch(getAllProposalsAct);\r\n\r\n        const subjects = await getAllSubjects();\r\n        const getAllSubjectsAct = getAllSubjectsAction(subjects);\r\n        store.dispatch(getAllSubjectsAct);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this._reqTodoList();\r\n    }\r\n\r\n    _extractYear(str) {\r\n        // Format in which the date is stored in the DB: 2019-10-07T03:34:16.921Z\r\n        // Slice the string using \"-\" and extract only the first element\r\n        return str.split(\"-\")[0];\r\n    }\r\n\r\n    _formatDataIntoTableList() {\r\n        const {proposals} = this.state;\r\n\r\n        let proposalList = [];\r\n\r\n        proposals.forEach(p => {\r\n            let nextProposal = {\r\n                year: this._extractYear(p.date),\r\n                name: p.name,\r\n                client: p.client.firstName + \" \" + p.client.lastName,\r\n                outlineOfProject: p.outlineOfProject,\r\n                status: p.status,\r\n                subjectId: p.subjectId\r\n            }\r\n\r\n            proposalList.push(nextProposal);\r\n        })\r\n\r\n        return proposalList;\r\n    }\r\n\r\n    _getSubjectFilterLookup() {\r\n        const {proposals} = this.state;\r\n\r\n        let subjectList = {};\r\n\r\n        proposals.forEach(p => {\r\n            if (! (p.subjectId in subjectList)) {\r\n                subjectList[p.subjectId] = p.subjectId;\r\n            }\r\n        })\r\n\r\n        return subjectList;\r\n    }\r\n\r\n    _handleClick(_id) {\r\n        const { history } = this.props;\r\n        history.push(`/dashboard/projects/${_id}`);\r\n    }\r\n\r\n    render() {\r\n        \r\n        return (\r\n            <MaterialTable\r\n                title=\"All Projects\"\r\n                columns={[\r\n                    { title: 'Year', field: 'year', filterCellStyle:{maxWidth:50} },\r\n                    { title: 'Proposal Name', field: 'name' },\r\n                    { title: 'Client', field: 'client' },\r\n                    { title: 'Description', field: 'outlineOfProject', filtering: false },\r\n                    { title: 'Status', field: 'status', lookup: { new: 'New', approved: 'Approved', rejected: 'Rejected'}, filterCellStyle:{paddingTop:0} },\r\n                    { title: 'Subject', field: 'subjectId', filterCellStyle:{maxWidth:50}, lookup: this._getSubjectFilterLookup(), filterCellStyle:{paddingTop:0} },\r\n                ]}\r\n                data={this._formatDataIntoTableList()}\r\n                options={{\r\n                    filtering: true,\r\n                }}\r\n                onRowClick={(event, rowData) => this._handleClick(rowData._id)}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nexport default (AllProposals);"]},"metadata":{},"sourceType":"module"}